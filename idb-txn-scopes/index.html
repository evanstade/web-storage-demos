<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>IDB overlapping readwrite transactions test</title>
    <link rel="stylesheet" href="style.css" />
    <script src="script.js" defer></script>
  </head>
  <body>
    <div style="font-weight: bold">
      Running test...
    </div>
    <p id="result-db1" class="lds-ring">
      <!-- Spinner -->
      <div></div><div></div><div></div><div></div>

      <!-- Results messages -->
      <span id="finished" hidden>Test finished: Concurrent R/W txns WERE allowed (if Chromium, probably using <span style="background-color:plum">LevelDB</span>)</span>
      <span id="timed-out" hidden>Test finished: Concurrent R/W txns WERE NOT allowed
        (probably using <span style="background-color:gold">SQLite</span>)
        </span>
    </p>
    <div id="explanation">
      <b>Explanation</b>
    <p>
      This test demonstrates your browser's treatment of concurrent IndexedDB readwrite transactions.
    </p>
    <p>
      There is a base set of constraints on transaction scheduling described by <a href="https://w3c.github.io/IndexedDB/#transaction-scheduling">see spec</a>. Some browsers add additional constraints, such as that multiple R/W transactions on the same database are always exclusive/unique.
    </p>
    <p>
      IRL sites are (hopefully) unlikely to rely on this behavior since Safari and Firefox have long had the more restrictive behavior, whereas Chromium was more permissive. For technical reasons related to ACIDity, Chromium is moving to match the behavior of the other browsers.
    </p>
    <p>
      One take-away for site owners is to prefer using distinct <a href="https://developer.mozilla.org/en-US/docs/Web/API/IDBDatabase">databases</a> rather than simply separate <a>object stores</a>, where possible. (And/or use separate <a href="https://developer.chrome.com/docs/web-platform/storage-buckets">storage buckets</a>.)
    </p>
    </div>
  </body>
</html>
